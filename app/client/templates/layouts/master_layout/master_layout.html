<template name="MasterLayout">
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Exchanger</a>
            </div>
            <div class="collapse navbar-collapse" id="header-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <form class="navbar-form" role="search">
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="{{_ "search"}}">
                                <span class="input-group-btn">
                                    <button type="submit" class="btn btn-default"><span class="glyphicon glyphicon-search"></span></button>
                                </span>
                            </div>
                        </form>
                    </li>
                    {{#if currentUser}}
                        <li>
                            <a href="/create_publication">
                                <span class="glyphicon glyphicon-plus-sign"></span>
                                &nbsp;&nbsp;{{_ "publish"}}
                            </a>
                        </li>
                        {{#if notificationsCount}}
                            <li class="dropdown">
                                <a class="dropdown-toggle" href="#" data-toggle="dropdown">
                                    <span class="glyphicon glyphicon-bell"></span>
                                    &nbsp;&nbsp;{{_ "notifications"}}&nbsp;&nbsp;
                                    
                                    <span class="badge">{{notificationsCount}}</span>
                                </a>
                                <div class="dropdown-menu panel-body" style="width: 250%;">
                                    <ul class="list-group list-unstyled">
                                    {{#each notifications}}
                                        <li class="clearfix">
                                            <div class="panel clearfix">
                                                <div class="list-group-item list-group-item-{{notificationColor}}">
                                                    <p class="list-group-item-heading">
                                                        {{#with notificationMessage}}
                                                            {{_ textKey from.profile.[first-name] from.profile.[last-name] price}}:
                                                        {{/with}}
                                                        {{#with getPublication publication}}
                                                            <a href="/publication/{{_id._str}}">
                                                                <h4><span class="label label-default">{{name}}</span></h4>
                                                            </a>
                                                        {{else}}
                                                            <h4><span class="label label-default">{{publication}}</span></h4>
                                                        {{/with}}
                                                    </p>
                                                </div>
                                                <div class="pull-right btn-group-sm ">
                                                    {{#if needsConfirmation}}
                                                        {{#if $eq type "deal"}}
                                                            <button class="confirmDeal btn btn-success">{{_ "button_confirm"}}</button>
                                                            <button class="rejectDeal  btn btn-danger">{{_ "button_reject"}}</button>
                                                        {{else}}
                                                            {{#if $eq type "bargain"}}
                                                                <button class="confirmBargain btn btn-success">{{_ "button_confirm"}}</button>
                                                                {{#unless checkBargainPrice}}
                                                                    <button class="keepBargaining btn btn-warning">{{_ "button_keepBargaining"}}</button>
                                                                {{/unless}}
                                                                <button class="stopBargaining btn btn-danger">{{_ "button_stopBargaining"}}</button>
                                                            {{/if}}
                                                        {{/if}}
                                                    {{else}}
                                                        <button class="closeNotification btn btn-sm btn-default">{{_ "button_close"}}</button>
                                                    {{/if}}
                                                </div>
                                            </div>
                                        </li>
                                    {{/each}}
                                    </ul>
                                </div>
                            </li>
                        {{/if}}
                    {{/if}}
                    <ul class="nav navbar-nav navbar-right">
                        {{> loginButtons}}
                    </ul>
                </ul>
            </div>
        </div>
    </nav>
    {{> yield}}
    <div class="clearfix"></div>
</template>
<template name="_loginButtonsAdditionalLoggedInDropdownActions">
    <button class="btn btn-default btn-block" id="login-buttons-edit-profile">{{_ "editProfile"}}</button>
</template>
